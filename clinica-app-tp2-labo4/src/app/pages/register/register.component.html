<h2>Registro</h2>

<form [formGroup]="usuarioForm" (ngSubmit)="onSubmit()" class="formulario">

    <mat-radio-group [(ngModel)]="tipoUsuario" (change)="handlerFormControls()" formControlName="tipoUsuario">
        <mat-radio-button value="paciente" >Paciente</mat-radio-button>
        <mat-radio-button value="especialista">Especialista</mat-radio-button>
       <ng-container *ngIf="isAdmin">
            <mat-radio-button value="admin">Administrador</mat-radio-button>
       </ng-container>
    </mat-radio-group>

    <mat-form-field appearance="fill">
        <mat-label>Nombre</mat-label>
        <input matInput formControlName="nombre" />
    </mat-form-field>

    <mat-form-field appearance="fill">
        <mat-label>Apellido</mat-label>
        <input matInput formControlName="apellido" />
    </mat-form-field>

    <mat-form-field appearance="fill">
        <mat-label>Edad</mat-label>
        <input matInput type="number" formControlName="edad" />
    </mat-form-field>

    <mat-form-field appearance="fill">
        <mat-label>DNI</mat-label>
        <input matInput formControlName="dni" />
    </mat-form-field>
    
    <div *ngIf="tipoUsuario == 'especialista'">
        <mat-form-field appearance="fill">
            <mat-label>Especialidad</mat-label>            
            <mat-select formControlName="especialidad">
                <mat-option *ngFor="let especialidad of especialidades" [value]="especialidad">{{especialidad}}</mat-option>
            </mat-select>
        </mat-form-field>
        <mat-form-field>
            <mat-label>Otra especialidad</mat-label>
            <input matInput [(ngModel)]="nuevaEspecialidad"  formControlName="nuevaEspecialidad" />
            <!-- <input matInput formControlName="especialidad" /> -->
        </mat-form-field>
        <button mat-raised-button color="primary" (click)="agregarEspecialidad()" type="button" aria-label="Agregar especialidad">
            <span>Agregar especialidad</span>
            <mat-icon>add</mat-icon>              
        </button>
    </div>
    
    <div *ngIf="tipoUsuario == 'paciente'">
        <mat-form-field appearance="fill">
            <mat-label>Obra Social</mat-label>            
            <input matInput formControlName="obraSocial" />
        </mat-form-field>
    </div>

    <mat-form-field appearance="fill">
        <mat-label>Email</mat-label>
        <input matInput formControlName="email" />
    </mat-form-field>

    <mat-form-field appearance="fill">
        <mat-label>Contrase√±a</mat-label>
        <input matInput type="password" formControlName="password" />
    </mat-form-field>

    <label>Imagen perfil:</label>
    <input type="file" (change)="onFileSelected($event, 'imagen', usuarioForm)" />

    <div *ngIf="tipoUsuario == 'paciente'" style="display: flex;flex-direction: column;gap:1rem">
        <label>Imagen perfil 2:</label>
        <input type="file" (change)="onFileSelected($event, 'imagen2', usuarioForm)" />
    </div>

    <button mat-raised-button color="primary" type="submit">Registrar</button>
</form>